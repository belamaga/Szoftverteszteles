<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <title>10.2. TDD alap√∫ adatb√°zis fejleszt√©s</title><link rel="stylesheet" href="style.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><link rel="home" href="index.html" title="Szoftvertesztel√©s"><link rel="up" href="ch10.html" title="10. fejezet - Adatb√°zisok tesztel√©se"><link rel="prev" href="ch10.html" title="10. fejezet - Adatb√°zisok tesztel√©se"><link rel="next" href="ch10s03.html" title="10.3. Adatb√°zis √∫jratervez√©s folyamata"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">10.2. TDD alap√∫ adatb√°zis fejleszt√©s</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch10.html">El&#337;z&#337;</a>&nbsp;</td><th width="60%" align="center">10. fejezet - Adatb√°zisok tesztel√©se</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch10s03.html">K√∂vetkez&#337;</a></td></tr></table><hr></div><div class="sect1" title="10.2. TDD alap√∫ adatb√°zis fejleszt√©s"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5491"></a>10.2. TDD alap√∫ adatb√°zis fejleszt√©s</h2></div></div></div><p>Az adatb√°zisok vil√°gban is nagy szerepe van a tesztel√©s orient√°lt fejleszt√©snek, vagyis  a TDD (test driven development) m√≥dszertannak. A  TDD m√≥dszertan alapelvei a k√∂vetkez&#337;kben 
                foglalhat√≥k √∂ssze:</p><div class="sect2" title="10.2.1. Fokozatos adatmodellez√©s"><div class="titlepage"><div><div><h3 class="title"><a name="d0e5496"></a>10.2.1. Fokozatos adatmodellez√©s</h3></div></div></div><p>A fokozatos modellez√©s szeml√©lete azt fejezi ki, hogy az adatb√°zis s√©ma √©s v√©delmi, hat√©konys√°gi modellj√©t nem egy l√©p√©sben, a fejleszt√©s elej√©n 
                        alak√≠tjuk ki, hanem menetk√∂zben t√∂bb f√°zison kereszt√ºl finomodik a modell.  A tervez√©s els&#337; f√°zis√°ban csak egy nagyvonal√∫ terv √°ll rendelkez√©sre, amely tartalmazza a 
                        f&#337; inform√°ci√≥ elemeket, de nem t√©r ki minden r√©szletre. A projekt fejl&#337;d√©se sor√°n egyre finomabb k√©p alakul ki a k√∂vetelm√©nyekr&#337;l √©s a modellezett ter√ºletr&#337;l. Ezen finom√≠t√°sok 
                        fokozatosan √©p√ºlnek be az adatb√°zis modellbe.  A tervez√©s fontosabb l√©p√©sei:
                        </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>indul√≥, els&#337;dleges k√∂vetelm√©ny modellez√©s</p></li><li class="listitem"><p>k√∂vetelm√©nyek pontos√≠t√°sa</p></li><li class="listitem"><p>√∫j modellelemek beolvaszt√°sa</p></li><li class="listitem"><p>k√≥dol√°s</p></li><li class="listitem"><p>tesztel√©s</p></li><li class="listitem"><p>vissza a 2. pontra</p></li></ol></div><p>
                           A fenti modell teh√°t egy folyamatos √©s fokozatos modell √©s program finom√≠t√°st  √©s k√∂zel√≠t√©st tartalmaz, ahol a tev√©kenys√©gek fontos eleme az ism√©tl&#337;d&#337;, egyre 
                           √°tfog√≥bb tesztek lefuttat√°sa.
                        </p><div class="figure"><a name="d0e5521"></a><p class="title"><b>10.1. √°bra - A TDD alap√∫ fejleszt√©s l√©p√©sei</b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://gyires.inf.unideb.hu/KMITT/c12/images\abra_tdd.png" align="middle" alt="A TDD alap√∫ fejleszt√©s l√©p√©sei"></div></div></div><br class="figure-break"></div><div class="sect2" title="10.2.2. Visszir√°ny√∫ adatmodellez√©s"><div class="titlepage"><div><div><h3 class="title"><a name="d0e5527"></a>10.2.2. Visszir√°ny√∫ adatmodellez√©s</h3></div></div></div><p>A visszir√°ny√∫, regresszi√≥s tesztek szerepe, hogy az adatb√°zis s√©ma m√≥dos√≠t√°sa ut√°n meggy&#337;z&#337;dhess√ºnk arr√≥l. hogy a kor√°bban megval√≥s√≠tott funkci√≥k tov√°bbra is 
                        √©rv√©nyesek, j√≥l m&#369;k√∂dnek.  A biztons√°g √©s min&#337;s√©g orient√°lt fejleszt√©s alapelve, hogy ezen teszteket minden v√°ltoz√°s ut√°n lefuttassuk, teh√°t a tesztel√©s tulajdonk√©ppen a 
                        m√≥dos√≠t√°s r√©sz√©v√© v√°lik. Ezen megk√∂zel√≠t√©s egyik mark√°ns k√©pvisel&#337;je az el&#337;tesztel&#337; programoz√°s (TFD, test first development), mely el&#337;√≠rja, hogy a tesztek elk√©sz√≠t√©se legyen 
                        az els&#337; l√©p√©s a fejleszt√©sben, mivel √∫gyis addig kell m√≥dos√≠tani a modellen, am√≠g a kapcsol√≥d√≥ tesztek le nem futnak. A TFD alap√∫ fejleszt√©s f&#337;bb l√©p√©sei:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>indul√≥ teszt el&#337;√°ll√≠t√°sa a k√≠v√°nt funkci√≥hoz</p></li><li class="listitem"><p>a teszt futtat√°sa; ha sikeres √°t lehet t√©rni a k√∂vetkez&#337; funkci√≥ra √©s √≠gy vissza az 1. pontra; ha nem siker√ºl tov√°bbl√©p√©s a 3. pontra</p></li><li class="listitem"><p>a modell m√≥dos√≠t√°sa egy kisebb, kezelhet&#337; m√©rt√©kben</p></li><li class="listitem"><p>a teszt futtat√°sa; ha sikeres √°t lehet t√©rni a k√∂vetkez&#337; funkci√≥ra √©s √≠gy vissza az 1. pontra; ha nem siker√ºl visszal√©p√©s a 3. pontra</p></li></ol></div><p>Az TFD megk√∂zel√≠t√©s el&#337;nye, hogy a tervez&#337; jobban √°tgondolja a c√©lokat, m√©lyebben felt√°r√≥dnak az ig√©nyelt  v√°ltoz√°sok jellegzetess√©gei.  Az elk√©sz√≠tett tesztek jobban 
                            lokaliz√°l√≥dnak egy-egy probl√©mak√∂rre ez√©rt alaposabban ellen&#337;rz√©s hajt√≥dik v√©gre. Term√©szetesen ennek velej√°r√≥ja, hogy nagyobb feladatok fog jelenteni a tesztek 
                            meg√≠r√°sa √©s v√©grehajt√°sa. Tov√°bbi el&#337;nynek tekinthet&#337; az is, hogy a TFD megk√∂zel√≠t√©sben a fejleszt&#337; hamarabb lez√°rhatja az egyes modulok fejleszt√©s√©t, hiszen 
                        hamarabb kap visszajelz√©st az elv√©gzett munka min&#337;s√©g√©r&#337;l.</p></div><div class="sect2" title="10.2.3. Verzi√≥ k√∂vet√©s biztos√≠t√°sa"><div class="titlepage"><div><div><h3 class="title"><a name="d0e5547"></a>10.2.3. Verzi√≥ k√∂vet√©s biztos√≠t√°sa</h3></div></div></div><p>A fokozatos adatb√°zis fejleszt√©s sor√°n el&#337;fordulhat, hogy egy adott m√≥dos√≠t√°s nagyon sikertelennek bizonyul. Ekkor c√©lszer&#369;bb √∫jra visszat√©rni ez el&#337;z&#337; √©rv√©nyes, helyes 
                        √°llapothoz, mint foltozgatni a m√°r meg√≠rt m√≥dos√≠t√°sokat. A kor√°bbi √°llapotokhoz t√∂rt√©n&#337; visszat√©r√©s egyfajta verzi√≥k√∂vet√©st ig√©nyel, hiszen meg&#337;rizz√ºk a kor√°bbi fejleszt√©si √°llapotokat. 
                        Az adatb√°zis s√©ma menedzsmentj√©nek egyedi von√°sa, hogy  t√∂bb elemet is le kell fednie. A verzi√≥kezel√©sbe  bevonand√≥ elemek k√∂re:</p><table border="0" summary="Simple list" class="simplelist"><tr><td>adatb√°zis objektumok (table, view, user,...) szerkezet le√≠r√°sa </td></tr><tr><td>v√©delmi  be√°ll√≠t√°sok</td></tr><tr><td>integrit√°si be√°ll√≠t√°sok</td></tr><tr><td>adatb√°zis k√≥dok (t√°rolt elj√°r√°s, trigger,..)</td></tr><tr><td>adatb√°zis param√©terek</td></tr></table><p>
                         A fenti adatok k√©t nagy forr√°sb√≥l szedhet&#337;k √∂ssze:
                         </p><table border="0" summary="Simple list" class="simplelist"><tr><td>adatb√°zis metaadat t√°bl√°k tartalma</td></tr><tr><td>k√ºls&#337; konfigur√°ci√≥s √°llom√°nyok tartalma</td></tr></table><p>
                           A piacon l√©teznek gy√°ri megold√°sok, mint p√©ld√°ul az SVCO rendszer az Oracle 
                           RDBMS-hez. Az SVCO rendszer egy teljesen PL/SQL k√≥dban meg√≠rt verzi√≥ k√∂vet&#337; rendszer, amely az Oracle szerveren bel√ºl egy k√ºl√∂n adatb√°zisban t√°rolja le a kijel√∂lt 
                           adatb√°zis s√©m√°iban bek√∂vetkez&#337; v√°ltoz√°sokat.   A verzi√≥kezel√©s term√©szetesen t√∂rt√©nhet egyedi megold√°ssal, az √©rintett le√≠r√≥ elemek m√°sol√°s√°val √©s kiment√©s√©vel. Az Oracle 
                           eset√©ben t√∂bbtucat metaadat n√©zeti t√°bla √°ll rendelkez√©sre DBA hat√°sk√∂rben a s√©ma adatok kiolvas√°s√°ra. N√©h√°ny fontosabb s√©male√≠r√≥ t√°bla:                          
                         </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>DBA_TABLES:  adatb√°zis t√°bl√°k adatai</p></li><li class="listitem"><p>DBA_COLUMNS: adatt√°bla mez&#337;k le√≠r√°sa</p></li><li class="listitem"><p>DBA_TAB_PRIVS: objektum jogok le√≠r√°sa</p></li><li class="listitem"><p>DBA_USERS: felhaszn√°l√≥k adatai</p></li><li class="listitem"><p>DBA_CONSTRAINTS: megszor√≠t√°sok le√≠r√°sa</p></li><li class="listitem"><p>DBA_ROLES: szerepk√∂r√∂k adatai</p></li><li class="listitem"><p>DBA_PROCEDURES: t√°rolt elj√°r√°sok adatai</p></li><li class="listitem"><p>DBA_SOURCE: t√°rolt elj√°r√°sok k√≥djai</p></li></ul></div><p>A fenti metaadat √°llom√°nyok tartalm√°nak kinyer√©s√©re t√∂bb m√≥d is k√≠n√°lkozik:
                        </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>SELECT * FROM .. : tartalom k√∂zvetlen lek√©rdez√©se</p></li><li class="listitem"><p>COPY  FROM forr√°s_db TO c√©l_db  [CREATE | REPLACE] t√°bla    USING lek√©rdez√©s  : t√°bla √°tm√°sol√°sa  </p></li><li class="listitem"><p>trigger k√∂t√©se a tartalom  m√≥dos√≠t√°s√°hoz : CREATE TRIGGER AFTER UPDATE ON t√°bla FOR EACH ROW ..... A trigger t√∂rzs√©ben lehet 
                                szerepeltetni a tartalom kiolvas√°s√°t √©s m√°sol√°s√°t v√©gz&#337; utas√≠t√°sokat..</p></li><li class="listitem"><p>IMPORT seg√©dprogram futtat√°sa a magadott t√°bl√°kra</p></li></ul></div><p>
                            
                        
            </p><p>Az egyes adatb√°zis objektumok s√©ma le√≠r√°sakor hasznos inform√°ci√≥ a kapcsol√≥d√≥ jelent√©s magyar√°zat. Ehhez az Oracle-ben a 
                        </p><pre class="programlisting">
COMMENT ON objektum IS sz√∂veg;                            
                        </pre><p>
                          SQL parancs haszn√°lhat√≥.  A fenti parancs seg√≠ts√©g√©vel a jelent√©st magyar√°z√≥ sz√∂veget adhatunk a s√©m√°hoz. A megadott le√≠r√°s a 
                          </p><pre class="programlisting">
SELECT COMMENTS  FROM  USER_TAB_COMMENTS WHERE ...;
SELECT COMMENTS  FROM  USER_COL_COMMENTS WHERE ...;
                          </pre><p>
                            parancsokkal k√©rdezhet&#337;k le.
                        </p></div><div class="sect2" title="10.2.4. Adatb√°zis homokoz√≥k, munkak√∂rnyezetek biztos√≠t√°sa"><div class="titlepage"><div><div><h3 class="title"><a name="d0e5621"></a>10.2.4. Adatb√°zis homokoz√≥k, munkak√∂rnyezetek biztos√≠t√°sa</h3></div></div></div><p>A hagyom√°nyos szotfver fejleszt√©shez hasonl√≥an az adatb√°zisok eset√©ben is t√∂bb f√°zisb√≥l √°ll a fejleszt√©s, √∫gymint tervez√©s, k√≥dol√°s, tesztel√©s √©s bevezet√©s.  Ezen 
                        f√°zisok elt√©r&#337; ig√©nyeket jelentenek az adatb√°zissal szemben, hiszen m√≠g p√©ld√°ul a k√≥dol√°s szakasz√°ban m√©g el&#337;fordulhatnak hib√°k (a hiba n√©lk√ºl k√≥dol√°s igen ritka jelens√©g), addig
                        a bevezet√©sn√©l m√°r nem szabadna hib√°kat tartalmaznia a rendszernek. A m&#369;k√∂d&#337; rendszern√©l a stabilit√°s a legfontosabb,  a fejleszt&#337; rendszern√©l pedig a rugalmass√°g. Ezen 
                        elt√©r&#337; k√∂vetelm√©nyek miatt c√©lszer&#369; az adatb√°zist is t√∂bb p√©ld√°nyban megval√≥s√≠tani, az egyes munkacsoportoknak saj√°t adatb√°zis k√∂rnyezetet biztos√≠tani. Az ilyen egyedi ig√©nyeket
                        kiel√©g√≠t&#337; adatb√°zis p√©ld√°nyokat nevezik homokoz√≥knak (sandbox). Az adatb√°zis fejleszt√©sn√©l az al√°bbi homokoz√≥ p√©ld√°nyokat szok√°s megk√ºl√∂nb√∂ztetni:
                        </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>fejleszt&#337;i k√∂rnyezet (development sandbox): </p></li><li class="listitem"><p>projekt integr√°ci√≥s k√∂rnyezet (project integration sandbox): </p></li><li class="listitem"><p>demonstr√°ci√≥s k√∂rnyezet (demo sandbox): </p></li><li class="listitem"><p>bevezet√©si teszt k√∂rnyezet (pre-production test sandbox):</p></li><li class="listitem"><p>√ºzemi, √©les k√∂rnyezet (production)</p></li></ul></div><div class="figure"><a name="d0e5642"></a><p class="title"><b>10.2. √°bra - Adatb√°zis v√°ltozatok, homokoz√≥k</b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://gyires.inf.unideb.hu/KMITT/c12/images\abra_sandbox.png" align="middle" alt="Adatb√°zis v√°ltozatok, homokoz√≥k"></div></div></div><br class="figure-break"><p>Az egyes p√©ld√°nyok l√©trehoz√°sa t√∂rt√©nhet manu√°lisan, egyedi DBA parancsokkal is, A k√∂vetkez&#337;kben bemutatjuk az adatb√°zis m√°sol√°s parancsait az Oracle DBMS p√©ld√°j√°n kereszt√ºl
                            [Jeff Hunter, Sr. Database Administrator:  http://www.idevelopment.info/data/Oracle/DBA_tips/Backup_and_Recovery/BandR_2.shtml]
                           </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Az adatb√°zis aktu√°lis √°llom√°nyainak  sz√°mbav√©tele, majd m√°sol√°sa egy √∫j helyre. Az √°llom√°nyokat az al√°bbi parancsokkal lehet felder√≠teni:
                                        </p><table border="0" summary="Simple list" class="simplelist"><tr><td>select name from v$database;</td></tr><tr><td>select name from v$datafile;</td></tr></table><p>
                               
                     </p></li><li class="listitem"><p>⁄j inicializ√°ci√≥s √°llom√°ny k√©sz√≠t√©se. Ehhez az INITx.ORA √°llom√°nyt kell √°tm√°solni √©s √∫j nevet adni. A inicializ√°ci√≥s √°llom√°nyban az al√°bbi param√©tereket 
                               kell aktualiz√°lni:
                               </p><table border="0" summary="Simple list" class="simplelist"><tr><td>db_name</td></tr><tr><td>control_files</td></tr><tr><td>audit_file_dest</td></tr><tr><td>background_dump_dest</td></tr><tr><td>log_archive_dest</td></tr><tr><td>core_dump_dest</td></tr><tr><td>user_dump_dest</td></tr></table><p>
                                   
                               
                     </p></li><li class="listitem"><p>Vez√©rl&#337; √°llom√°nyok l√©trehozatala. ehhez a forr√°s control file tartalmat kell √°tm√°solni. Ehhez az al√°bbi SQL parancsot kell kiadni:
                               </p><table border="0" summary="Simple list" class="simplelist"><tr><td>alter database backup controlfile to trace;</td></tr></table><p>
                                   Ezt k√∂vet&#337;en az √∫j vez√©rl&#337; √°llom√°nyt el&#337;√°ll√≠t√≥ SQL parancssort kell l√©trehozni. A parancssor szerkezete:
                                   </p><pre class="programlisting">
STARTUP NOMOUNT
CREATE CONTROLFILE SET DATABASE "xxx" RESETLOGS NOARCHIVELOG
    MAXLOGFILES xx
    MAXLOGMEMBERS xx
    MAXDATAFILES xx
    MAXINSTANCES xx
    MAXLOGHISTORY xx
LOGFILE
  GROUP 1 (
    '/u03/app/oradata/xxx/redo_g01a.log',
    '/u04/app/oradata/xxx/redo_g01b.log',
    '/u05/app/oradata/xxx/redo_g01c.log'
  ) SIZE 200K,
  GROUP 2 (
...
) SIZE 200K,
DATAFILE
  '/u08/app/oradata/xxx/system01.dbf',
  '/u06/app/oradata/xxx/rbs01.dbf',
  '/u07/app/oradata/xxx/temp01.dbf',
  '/u10/app/oradata/xxx/userd01.dbf',
  '/u09/app/oradata/xxx/userx01.dbf';                                       
                                   </pre><p>
                                   
                               
                     </p><p>Ezt k√∂vet&#337;en lefuttathat√≥ DBA-k√©nt az el&#337;bb elk√©sz√≠tett parancssor.</p></li><li class="listitem"><p>A most l√©trehoz√°sra el&#337;k√©sz√≠tett p√©ld√°ny √©les√≠thet&#337;, elind√≠that√≥. A v√©gleges√≠t√©s parancsai:
                               </p><table border="0" summary="Simple list" class="simplelist"><tr><td>alter database recover database until cancel using backup controlfile;</td></tr><tr><td>alter database recover cancel;</td></tr><tr><td>alter database open resetlogs;</td></tr></table><p>
                                   
                               
                     </p></li></ol></div><p>
                             
                        
            </p><p>
                            A teljes adatb√°zis s√©ma √°tm√°sol√°sra DBMS-be √©p√≠tett seg√©dprogramok 
                            √°llnak rendelkez√©sre. Az Oracle eset√©ben az EXPORT / IMPORT rutinokat lehet alkalmazni ezen c√©lra.  Mindk√©t parancsn√°l egy k√ºl√∂n parancs√°llom√°nyba szok√°s √∂sszefoglalni a 
                            parancs param√©tereket. A  ment√©s √©s bet√∂lt√©s t√∂bb k√ºl√∂nb√∂z&#337; √ºzemm√≥dban futhat le:
                             </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>teljes adatb√°zis √°tvitele</p></li><li class="listitem"><p>kijel√∂lt felhaszn√°l√≥ adatait vagy egy√©b m√≥don kijel√∂lt objektumokat  √©rint csak a m&#369;velet</p></li><li class="listitem"><p>integrit√°si elemek √°tvihet&#337;k vagy kihagyhat√≥k</p></li><li class="listitem"><p>adattartalom √°tvitele vagy kihagy√°sa (csak s√©ma)</p></li><li class="listitem"><p>jogosults√°gai adatok √°tvitele vagy kihagy√°sa</p></li></ul></div><p>
                            Egy minta parancsind√≠t√°st ad meg a k√∂vetkez&#337; parancs:
                            </p><pre class="programlisting">
 exp SYSTEM/password FULL=y FILE=dba.dmp LOG=dba.log CONSISTENT=y                               
                            </pre><p>
                        
            </p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch10.html">El&#337;z&#337;</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch10.html">Fel</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch10s03.html">K√∂vetkez&#337;</a></td></tr><tr><td width="40%" align="left" valign="top">10. fejezet - Adatb√°zisok tesztel√©se&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Tartalom</a></td><td width="40%" align="right" valign="top">&nbsp;10.3. Adatb√°zis √∫jratervez√©s folyamata</td></tr></table></div></body></html>